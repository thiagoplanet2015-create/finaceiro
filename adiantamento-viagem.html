<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solicitação de Adiantamento para Viagens</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    :root {
      --brand: #72bf44;
      --brand-600: #5fa535;
      --ink: #0f172a;
      --muted: #64748b;
      --paper: #ffffff;
      --bg: #f3f6fb;
      --border: #e5e7eb;
    }

    body {
      background: var(--bg);
      color: var(--ink);
    }

    h1,
    h2,
    h3,
    h4,
    h5 {
      color: var(--ink);
      letter-spacing: .2px;
    }

    .topbar {
      background: linear-gradient(135deg, var(--brand) 0%, var(--brand-600) 100%);
      color: #fff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .topbar .fw-bold {
      color: #fff;
      font-size: 1.2rem;
    }

    .topbar .text-muted {
      color: rgba(255, 255, 255, 0.85) !important;
    }

    .card {
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(2, 6, 23, .05);
    }

    .card-header {
      background: linear-gradient(180deg, #f8fdf5, #e8f5e0);
      border-bottom: 1px solid var(--border);
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
    }

    .card-header h5 {
      color: var(--brand-600);
      font-weight: 700;
    }

    .form-label {
      font-weight: 600;
      color: #334155;
    }

    .form-control,
    .form-select {
      border-radius: 10px;
      border: 1px solid var(--border);
    }

    .form-control:focus,
    .form-select:focus {
      border-color: var(--brand);
      box-shadow: 0 0 0 .2rem rgba(114, 191, 68, .25);
    }

    .btn-primary {
      background: var(--brand);
      border-color: var(--brand);
      border-radius: 10px;
      font-weight: 600;
    }

    .btn-primary:hover {
      background: var(--brand-600);
      border-color: var(--brand-600);
    }

    .hidden {
      display: none;
    }
  </style>
</head>

<body>
  <nav class="topbar">
    <div class="container py-2 d-flex align-items-center justify-content-between">
      <div class="fw-bold">Solicitação de Adiantamento para Viagens</div>
      <div class="text-muted small">
        Empresa: <span id="empresaSpan">EMPRESA_A</span> • Usuário: <span id="usuarioSpan">agt@agt.com.br</span>
      </div>
    </div>
  </nav>

  <div class="container my-4">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <!-- Card: Dados do Colaborador -->
        <div class="card mb-4">
          <div class="card-header">
            <h5><i class="fas fa-user-circle me-2"></i>Dados do Colaborador</h5>
          </div>
          <div class="card-body">
            <form id="formRecibo" novalidate>
              <div class="mb-3">
                <label for="empresa" class="form-label">Empresa</label>
                <select id="empresa" class="form-select" required>
                  <option value="" selected>Selecione a empresa</option>
                  <option value="05">05 - Agroterenas Citrus Ltda.</option>
                  <option value="11">11 - Agroterenas Industrial Citrus Ltda.</option>
                  <option value="16">16 - Agroterenas S/A - Cana</option>
                  <option value="17">17 - XXXXXXXX</option>
                  <option value="20">20 - Agt Estrela do Oeste</option>
                  <option value="21">21 - Agroterenas International E.C.</option>
                  <option value="24">24 - Agroterenas International LLC</option>
                  <option value="30">30 - Agroterenas S/A - Administração e Participações</option>
                  <option value="40">40 - Agroventura</option>
                  <option value="41">41 - Agroterenas Terras Ltda.</option>
                  <option value="42">42 - Associação Semear</option>
                  <option value="43">43 - AGT Adubos e Fertilizantes</option>
                </select>
                <div class="invalid-feedback">Selecione uma empresa.</div>
              </div>




              <div class="mb-3">
                <label for="nome" class="form-label">Nome completo</label>
                <input type="text" id="nome" class="form-control" required />
                <div class="invalid-feedback">Informe o nome.</div>
              </div>

              <div class="row g-2">
                <div class="col-md-6">
                  <label for="rg" class="form-label">RG</label>
                  <input type="text" id="rg" class="form-control" placeholder="Ex: 12.345.678-9" required />
                  <div class="invalid-feedback">Informe o RG.</div>
                </div>
                <div class="col-md-6">
                  <label for="cpf" class="form-label">CPF</label>
                  <input type="text" id="cpf" class="form-control" placeholder="XXX.XXX.XXX-XX" required />
                  <div class="invalid-feedback">CPF inválido.</div>
                </div>
              </div>

              <div class="mb-3 mt-3">
                <label for="nacionalidade" class="form-label">Nacionalidade</label>
                <input type="text" id="nacionalidade" class="form-control" value="Brasileiro(a)" required />
              </div>

              <!-- Endereço separado -->
              <div class="row g-2 mb-2">
                <div class="col-md-8">
                  <label for="rua" class="form-label">Rua</label>
                  <input type="text" id="rua" class="form-control" placeholder="Nome da rua" required />
                  <div class="invalid-feedback">Informe a rua.</div>
                </div>
                <div class="col-md-4">
                  <label for="numero" class="form-label">Número</label>
                  <input type="text" id="numero" class="form-control" placeholder="Nº" required />
                  <div class="invalid-feedback">Informe o número.</div>
                </div>
              </div>

              <div class="row g-2 mb-3">
                <div class="col-md-6">
                  <label for="bairro" class="form-label">Bairro</label>
                  <input type="text" id="bairro" class="form-control" placeholder="Bairro" required />
                  <div class="invalid-feedback">Informe o bairro.</div>
                </div>
                <div class="col-md-6">
                  <label for="cidade" class="form-label">Cidade</label>
                  <input type="text" id="cidade" class="form-control" placeholder="Cidade/UF" required />
                  <div class="invalid-feedback">Informe a cidade.</div>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Card: Forma de Pagamento -->
        <div class="card mb-4">
          <div class="card-header">
            <h5><i class="fas fa-money-check-alt me-2"></i>Forma de Pagamento</h5>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <label for="formaPagamento" class="form-label">Selecione a forma de pagamento</label>
              <select id="formaPagamento" class="form-select" required onchange="togglePagamento()">
                <option value="">Selecione</option>
                <option value="Dinheiro">Dinheiro</option>
                <option value="Depósito">Depósito Bancário</option>
              </select>
              <div class="invalid-feedback">Selecione a forma de pagamento.</div>
            </div>

            <!-- Campos bancários (aparecem apenas se Depósito for selecionado) -->
            <div id="dadosBancarios" class="hidden">
              <div class="mb-3">
                <label for="banco" class="form-label">Banco</label>
                <input type="text" id="banco" class="form-control" placeholder="Banco XYZ" />
              </div>

              <div class="row g-2 mb-3">
                <div class="col-4">
                  <label for="agencia" class="form-label">Agência</label>
                  <input type="text" id="agencia" class="form-control" />
                </div>
                <div class="col-8">
                  <label for="conta" class="form-label">Conta</label>
                  <input type="text" id="conta" class="form-control" placeholder="Número + dígito" />
                </div>
              </div>

              <div class="mb-0">
                <label for="tipoConta" class="form-label">Tipo de Conta</label>
                <select id="tipoConta" class="form-select">
                  <option value="">Selecione</option>
                  <option value="Conta Corrente">Conta Corrente</option>
                  <option value="Poupança">Poupança</option>
                  <option value="Salário">Salário</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Card: Adiantamento -->
        <div class="card mb-4">
          <div class="card-header">
            <h5><i class="fas fa-money-bill-wave me-2"></i>Adiantamento</h5>
          </div>
          <div class="card-body">
            <div class="row g-3">
              <div class="col-md-6">
                <label for="valor" class="form-label">Valor (R$)</label>
                <input type="number" step="0.01" id="valor" class="form-control" required />
                <div class="invalid-feedback">Informe o valor.</div>
              </div>
              <div class="col-md-6">
                <label for="dataPagamento" class="form-label">Data do pagamento</label>
                <input type="date" id="dataPagamento" class="form-control" required />
              </div>
            </div>

            <div class="mt-3">
              <label for="motivo" class="form-label">Motivo / Descrição da viagem</label>
              <textarea id="motivo" class="form-control" rows="3" placeholder="Descrever motivo" required></textarea>
              <div class="invalid-feedback">Descreva o motivo.</div>
            </div>
          </div>
        </div>

        <!-- Card: Local e Data -->
        <div class="card mb-4">
          <div class="card-header">
            <h5><i class="fas fa-map-marker-alt me-2"></i>Cidade/Estado e Data do Recibo</h5>
          </div>
          <div class="card-body">
            <div class="row g-2">
              <div class="col-md-6">
                <label for="local" class="form-label">Local</label>
                <input type="text" id="local" class="form-control" placeholder="Ex: Maracaí/SP" required />
              </div>
              <div class="col-md-6">
                <label for="dataRecibo" class="form-label">Data</label>
                <input type="date" id="dataRecibo" class="form-control" required />
              </div>
            </div>

            <div class="alert alert-info mt-3 mb-0">
              <small><strong>Observação:</strong> O colaborador declara que, havendo sobra, devolverá em até 3 dias do
                retorno com a devida prestação de contas.</small>
            </div>
          </div>
        </div>

        <!-- Botão Gerar -->
        <div class="d-grid gap-2">
          <button class="btn btn-primary btn-lg" type="button" onclick="gerarRecibo()">
            <i class="fas fa-file-invoice me-2"></i>Gerar Recibo »
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Contexto do login
    const empCtx = sessionStorage.getItem('empresa') || 'EMPRESA_A';
    const usrCtx = sessionStorage.getItem('usuario') || 'agt@agt.com.br';
    document.getElementById('empresaSpan').textContent = empCtx;
    document.getElementById('usuarioSpan').textContent = usrCtx;

    function togglePagamento() {
      const forma = document.getElementById('formaPagamento').value;
      const dadosBancarios = document.getElementById('dadosBancarios');

      if (forma === 'Depósito') {
        dadosBancarios.classList.remove('hidden');
      } else {
        dadosBancarios.classList.add('hidden');
      }
    }

    function cpfValido(c) {
      const clean = (c || '').replace(/\D/g, '');
      return clean.length === 11;
    }

    function gerarRecibo() {
      const form = document.getElementById('formRecibo');
      let ok = true;
      const req = ['empresa', 'nome', 'rg', 'cpf', 'rua', 'numero', 'bairro', 'cidade', 'formaPagamento', 'valor', 'dataPagamento', 'motivo', 'local', 'dataRecibo'];

      req.forEach(id => {
        const el = document.getElementById(id);
        const v = el.value && el.value.toString().trim();
        if (!v || (id === 'cpf' && !cpfValido(v))) {
          el.classList.add('is-invalid');
          ok = false;
        } else {
          el.classList.remove('is-invalid');
        }
      });

      // Validar campos bancários se Depósito for selecionado
      const formaPagamento = document.getElementById('formaPagamento').value;
      if (formaPagamento === 'Depósito') {
        const bancarios = ['banco', 'agencia', 'conta', 'tipoConta'];
        bancarios.forEach(id => {
          const el = document.getElementById(id);
          const v = el.value && el.value.toString().trim();
          if (!v) {
            el.classList.add('is-invalid');
            ok = false;
          } else {
            el.classList.remove('is-invalid');
          }
        });
      }

      if (!ok) {
        alert('Preencha todos os campos obrigatórios corretamente.');
        return;
      }

      // Montar endereço completo
      const rua = document.getElementById('rua').value;
      const numero = document.getElementById('numero').value;
      const bairro = document.getElementById('bairro').value;
      const cidade = document.getElementById('cidade').value;
      const enderecoCompleto = `${rua}, ${numero}, ${bairro}, ${cidade}`;

      // Salvar dados no sessionStorage
      const dados = {
        empresa: document.getElementById('empresa').value,
        nome: document.getElementById('nome').value,
        rg: document.getElementById('rg').value,
        cpf: document.getElementById('cpf').value,
        nacionalidade: document.getElementById('nacionalidade').value,
        endereco: enderecoCompleto,
        formaPagamento: formaPagamento,
        banco: formaPagamento === 'Depósito' ? document.getElementById('banco').value : '',
        agencia: formaPagamento === 'Depósito' ? document.getElementById('agencia').value : '',
        conta: formaPagamento === 'Depósito' ? document.getElementById('conta').value : '',
        tipoConta: formaPagamento === 'Depósito' ? document.getElementById('tipoConta').value : '',
        valor: Number(document.getElementById('valor').value),
        dataPagamento: document.getElementById('dataPagamento').value,
        motivo: document.getElementById('motivo').value,
        local: document.getElementById('local').value,
        dataRecibo: document.getElementById('dataRecibo').value
      };

      sessionStorage.setItem('dadosRecibo', JSON.stringify(dados));
      window.location.href = 'adiantamento-viagem-recibo.html';
    }

    // Inicializar datas
    document.addEventListener('DOMContentLoaded', function () {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('dataPagamento').value = today;
      document.getElementById('dataRecibo').value = today;
    });
  </script>
</body>

</html>